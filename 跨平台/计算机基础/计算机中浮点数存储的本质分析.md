**目录**
[toc]

标题：计算机中浮点数存储的本质分析

## 浮点存储本质

-----

目前计算机中多采用IEEE确定的浮点存储标准算法，**核心原理**为将浮点的整数用2的指数来表达压缩，小数用2的负指数来表达压缩。

### IEEE标准算法

- 分为指数位+小数位，将整数的表达更压缩

- float: 32位固定分配为1bit符号位，8bits指数位，23bits尾数位（注：不完全是小数）

- double:64位固定分配为1bit符号位，11bits指数位，52bits尾数位（注：不完全是小数）

### 实例分析

#### 总体过程

浮点存储总体过车如下图：
![在这里插入图片描述](https://img-blog.csdnimg.cn/1db3fd62a0c24c00928f7bb9659de43c.png)

#### 过程分析

基本流程如下图：
![在这里插入图片描述](https://img-blog.csdnimg.cn/e5749090e9814940990fc5d20c7db62d.PNG)

下面以19.625的float存储为例，逐条具体分析：

- **整数转换，除2取余**
  - 19直接转为二进制10011
- **小数转换，乘2取整**
  - 0.625等于`1*2e-1+0*2e-2+1*2e-3`，对应二进制：101
  - 0.625x2=1.25，取整1，1对应的权重是2e-1=0.5
  - 0.25x2=0.5，取整0，0对应的权重是2e-2=0.25
  - 0.5x2=1，取整1，1对应的权重是2e-3=0.125
  - 从前往后得到权重由大到小，所以二进制结果按顺序取得为101
- **结果组合**
  - 将整数部分和小数部分的二进制组合
  - 19.625对应10011.101
  - 注：以上流程本质与定点数相同，结果与Q26标的定点数相同
- **科学计数法**
  - 移动小数点到第1位有效位后面
  - 将10011.101表示为1.0011101*2e4，尾数部分中含有整数（粉色部分）和小数（蓝色部分）
- **指数偏移**
  - 做偏移，将2^4的指数4+127=131（10000011）
  - 采用+127偏移目的，是为了保证用无符号数，也能表示负数，比如8位的-127，偏移后就是0，从0开始映射-127（此处目的部分存疑）
- **拼接组合**
  - 科学计数：1.0011101*2e4
  - 指数部分：10000011
  - 尾数部分：0011101
  - 总体结果：0 - 10000011 - 0011101 - 00000000....
  - 组合原则：符号位 - 指数部分 - 尾数部分 - 不足补零

以上，具体展示了一个浮点数转换到计算机中的二进制存储过程，其他浮点转换依此类推。

## 参考资料

-----

1. [腾讯云：C语言浮点数float类型的秘密](https://cloud.tencent.com/developer/article/1761753)

